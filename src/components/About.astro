---
import cvEs from '../data/cv.json';
import cvEn from '../data/cv-en.json';
---

<section id="about" class="py-10 px-6 transition-colors duration-300">
  <div class="max-w-5xl mx-auto 
    bg-zinc-50 border-zinc-200 
    dark:bg-zinc-900/40 dark:border-white/5 
    rounded-[3rem] p-8 md:p-16 relative overflow-hidden group shadow-sm dark:shadow-2xl">
    <div class="flex items-center gap-2 mb-16 justify-center">
      <h2 
        class="text-zinc-900 dark:text-white text-3xl font-bold tracking-tighter uppercase "
        data-es="Sobre Mí"
        data-en="About Me"
      >
        Sobre Mí
      </h2>
    </div>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
      <div class="space-y-6 md:space-y-8">
        <div class="space-y-4">
          <h2 class="text-zinc-600 dark:text-zinc-400 text-lg md:text-xl max-w-lg leading-relaxed"
              data-es={cvEs.hero.about}
              data-en={cvEn.hero.about}>
            {cvEs.hero.about}
          </h2>
        </div>
      </div>

      <div class="relative flex justify-center lg:justify-end">
        <div class="relative w-full max-w-[320px] md:max-w-[400px] aspect-square rounded-[2rem] overflow-hidden 
          bg-zinc-100  dark:to-zinc-950 dark:border-white/10 
          shadow-2xl transition-all duration-500 group">
          <img 
            src="/images/avatar.webp" 
            alt="Cándido Icon" 
            width="400" 
            height="400"
            class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"
          />
        </div>
      </div>
    </div>
  </div>
</section>

<script>
    const syncProjectLinks = () => {
    const isDark = document.documentElement.classList.contains('dark');
    const theme = isDark ? 'dark' : 'light';
    const lang = localStorage.getItem('lang') || 'es';
    
    const links = document.querySelectorAll('[data-project-link]');
    
    links.forEach(link => {
      const href = link.getAttribute('href');
      if (!href || href === '#' || href.startsWith('#')) return;

      try {
        const url = new URL(href, window.location.origin);
        url.searchParams.set('theme', theme);
        url.searchParams.set('lang', lang);
        link.setAttribute('href', url.toString());
      } catch (e) {
        console.error("Error al sincronizar el link:", href);
      }
    });
  };

  const updateProjects = () => {
    const lang = localStorage.getItem('lang') || 'es';
    const elements = document.querySelectorAll('#proyectos [data-es]');
    elements.forEach(el => {
      const text = el.getAttribute(`data-${lang}`);
      if (text) el.textContent = text;
    });
  };

  window.addEventListener('language-changed', updateProjects);
  
  const observer = new MutationObserver(syncProjectLinks);
  observer.observe(document.documentElement, { attributes: true, attributeFilter: ['class'] });

  updateProjects();
</script>