---
import { Sun, Moon } from 'lucide-react';
---

<button
  id="theme-toggle"
  type="button"
  class="relative z-[60] inline-flex items-center justify-center w-10 h-10 rounded-full 
    bg-zinc-100 border border-zinc-200 text-zinc-600 
    dark:bg-zinc-900/50 dark:border-white/5 dark:text-zinc-400
    hover:text-cyan-800 dark:hover:text-cyan-400 
    transition-all duration-300 pointer-events-auto cursor-pointer"
  aria-label="Toggle Dark Mode"
  title="Toggle Dark Mode"
>
  <div class="sun-icon"><Sun size={18} /></div>
  <div class="moon-icon"><Moon size={18} /></div>
</button>

<style>
  .sun-icon { display: none; }
  .moon-icon { display: block; }
  :global(.dark) .sun-icon { display: block; }
  :global(.dark) .moon-icon { display: none; }
</style>

<script>
  import { setTheme } from '../utils/theme';

  const setup = () => {
    const btn = document.querySelector('#theme-toggle');
    if (btn) {
      btn.addEventListener('click', () => {
        document.documentElement.classList.toggle('dark');
        const isDark = document.documentElement.classList.contains('dark');
        const newTheme = isDark ? 'dark' : 'light';
        setTheme(newTheme);
      }, { once: false });
    }
  };

  // Registrar inmediatamente
  setup();
  // Re-registrar si usas transiciones de Astro
  document.addEventListener('astro:after-swap', setup);
</script>